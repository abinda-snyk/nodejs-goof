version: 0.2

env:
  parameter-store:
    # Requires that you have a secure string in AWS Systems Manager Parameter Store
    # called "snykAuthToken" with your Snyk token.
    SNYK_TOKEN: "snykAuthToken"

phases:
  install:
    commands:
      - npm install -g snyk
      - snyk auth d5d20472-5889-4c67-b002-b81bca6d5396
      - npm install

  build:
    on-failure: CONTINUE
    commands:
      - snyk code test --severity-threshold=high 
      - bash -c "if [ $? -eq 1 ]; then exit 0; fi"
  post_build:
    commands: 
      - echo Entering final stage
      - snyk monitor --org=afac34f1-cdf7-4338-a58f-dff48e56c4e0

     
